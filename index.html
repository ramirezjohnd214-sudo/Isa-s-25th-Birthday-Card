<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy 25th Birthday, Isa!!!</title>
<link rel="preconnect" href="https://www.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&family=Indie+Flower&display=swap" rel="stylesheet">
<style>
  :root{
    --skyTop:#08182a;        /* deep indigo */
    --skyBottom:#0c2743;     /* lighter indigo */
    --glow:#ffffffd0;
    --accent:#7dd3fc;
    --grass:#0e1b22;
    --ui:#0b1220cc;
    --gold:#ffd166;
    --danger:#ff6b6b;
  }
  html,body{height:100%;margin:0;background:linear-gradient(to bottom,var(--skyTop),var(--skyBottom));color:#e6f1ff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;overflow:hidden}
  /* BACKGROUND ART */
  /* Full-bleed blurred fill */
.bg-fill{
  position:fixed; inset:0; z-index:1; pointer-events:none;
  width:100%; height:100%;
  object-fit:cover;       /* fills the screen */
  filter: blur(24px) brightness(.75) saturate(1.1);
  transform: scale(1.05); /* hide blur edges */
}

/* Crisp full artwork on top, uncropped */
.bg-img{
  position:fixed; inset:0; z-index:1; pointer-events:none;
  width:100%; height:100%;
  object-fit:contain;     /* shows the entire 1536x1024 image */
  image-rendering:auto;
}
/* 🌅 Smooth fade-in for background images */
.bg-fill,
.bg-img {
  opacity: 0;
  animation: fadeInImage 2.8s ease-out forwards;
}

@keyframes fadeInImage {
  0% { opacity: 0; transform: scale(1.05); }
  50% { opacity: 0.6; transform: scale(1.02); }
  100% { opacity: 1; transform: scale(1); }
}
/* ✨ Gentle shimmer as background fades in */
.bg-img::after {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 30% 40%, rgba(255,255,255,0.05), transparent 70%),
              radial-gradient(circle at 70% 60%, rgba(125,211,252,0.05), transparent 70%);
  animation: bgShimmer 6s ease-in-out infinite alternate;
}

@keyframes bgShimmer {
  0% { opacity: 0.3; }
  100% { opacity: 0.7; }
}

  /* CANVAS STARS */
  #star-canvas{position:fixed;inset:0;z-index:0;pointer-events:none;}
  /* INTERACTIVE STAR LAYER (DOM) */
  #message-layer{position:fixed;inset:0;z-index:2;pointer-events:none;}
  /* Add this keyframes block (anywhere in <style>) */
@keyframes twinklePulse {
  0%   { transform: scale(1);   box-shadow: 0 0 10px 2px #ffffffd0, 0 0 2px 1px #fff; opacity: 0.9; }
  50% { transform: scale(1.3);
      box-shadow: 0 0 25px 7px #ffffffee, 0 0 4px 2px #fff;
      opacity: 1; }
  100% { transform: scale(1);   box-shadow: 0 0 10px 2px #ffffffd0, 0 0 2px 1px #fff; opacity: 0.9; }
}
@keyframes sparkleBurst {
  0% { transform: scale(0); opacity: 0.8; box-shadow: 0 0 10px 4px #fff; }
  50% { transform: scale(2.5); opacity: 1; box-shadow: 0 0 20px 8px #fff, 0 0 40px 12px #ffd700; }
  100% { transform: scale(0); opacity: 0; box-shadow: none; }
}
.sparkle {
  position: absolute;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #fff;
  pointer-events: none;
  animation: sparkleBurst 0.9s ease-out forwards;
}
/* Update your .mstar rules */
.mstar{
  position:absolute; width:8px; height:8px; border-radius:50%;
  background:#fff; cursor:pointer; pointer-events:auto;
  /* existing glow (keep): */
  box-shadow:0 0 10px 2px var(--glow), 0 0 2px 1px #fff;

  /* smooth hover still works */
  transition:transform .12s;

  /* NEW: twinkle animation (duration customizable via CSS var) */
  animation: twinklePulse var(--dur, 2.8s) ease-in-out infinite;
}

/* Keep your hover behavior */
.mstar:hover{ transform: scale(1.5); }
.tooltip {
  position: absolute;
  transform: translate(-50%, -160%);
  padding: 0.35rem 0.6rem;
  background: rgba(0, 0, 0, 0.6);
  border: 1px solid rgba(255, 255, 255, 0.35);
  border-radius: 6px;
  color: #fff;
  font-size: 0.75rem;
  font-family: "Quicksand", sans-serif;
  white-space: nowrap;
  pointer-events: none;
  backdrop-filter: blur(4px);
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.25s ease, transform 0.25s ease;
}
@keyframes tooltipGlow {
  0% {
    box-shadow: 0 0 6px rgba(255, 255, 255, 0.4),
                0 0 12px rgba(125, 211, 252, 0.2);
  }
  50% {
    box-shadow: 0 0 14px rgba(255, 255, 255, 0.8),
                0 0 28px rgba(125, 211, 252, 0.6),
                0 0 45px rgba(255, 255, 255, 0.3);
  }
  100% {
    box-shadow: 0 0 6px rgba(255, 255, 255, 0.4),
                0 0 12px rgba(125, 211, 252, 0.2);
  }
}

/* add glow effect when hovering on star */
.mstar:hover .tooltip {
  opacity: 1;
  visibility: visible;
  transform: translate(-50%, -180%);
  animation: tooltipGlow 2.5s ease-in-out infinite;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translate(-50%, -150%) scale(0.9); }
  to { opacity: 1; transform: translate(-50%, -160%) scale(1); }
}
  /* UI BAR */
  /* Smaller, floating HUD in the top-right */
.hud {
  position:fixed;
  top:1rem;
  right:1rem;
  z-index:5;

  background:var(--ui);
  border:1px solid #ffffff24;
  backdrop-filter:blur(6px);

  border-radius:12px;
  padding:.6rem .8rem;

  display:flex;
  flex-direction:column;
  gap:.5rem;

  max-width:220px;
  width:max-content;
}

/* Title smaller, no huge bar */
.hud-title {
  font-size:.9rem;
  font-weight:600;
  color:#e6f1ff;
  margin:0;
  line-height:1.2;
  text-wrap:balance;
}

/* Stack buttons vertically on mobile */
.hud-buttons {
  display:flex;
  flex-wrap:wrap;
  gap:.5rem;
}

.hud-buttons button {
  flex:1 1 auto;
  white-space:nowrap;
  font-size:.8rem;
  line-height:1.2;
  padding:.5rem .6rem;
  border-radius:10px;
}

/* Remove pills since we're not showing message count anymore */
.pill { display:none!important; }

/* Remove giant CTA at the bottom if you want the bottom bar gone too */
.cta { display:none!important; }

@media (min-width:600px){
  .hud {
    max-width:none;
    width:auto;
  }
  .hud-buttons {
    flex-wrap:nowrap;
  }
  .hud-buttons button {
    flex:0 0 auto;
  }
}
  button, .btn{
    background:#111933; color:#e6f1ff; border:1px solid #ffffff28; border-radius:10px; padding:.5rem .75rem; font-weight:600; cursor:pointer;
  }
  button:hover{filter:brightness(1.2)}
  .ghost{background:transparent}
  .accent{border-color:#7dd3fc50}
  .danger{border-color:#ff6b6b70;color:#ffb3b3}
  /* FOOTER CTA */
  .cta{
    position:fixed; left:50%; bottom:1rem; transform:translateX(-50%);
    z-index:3; display:flex; gap:.5rem; align-items:center; background:var(--ui);
    border:1px solid #ffffff24; padding:.6rem .8rem; border-radius:12px; backdrop-filter:blur(6px)
  }
  /* MODALS */
  dialog{border:none; border-radius:16px; background:#0b1220f2; color:#e6f1ff; padding:1.25rem; width:min(520px,92vw)}
  dialog::backdrop{background:rgba(0,0,0,.5)}
  .field{display:grid; gap:.35rem; margin:.6rem 0}
  input[type="text"], input[type="email"], input[type="password"], textarea{
    width:100%; background:#0f1830; color:#e6f1ff; border:1px solid #ffffff24; border-radius:10px; padding:.55rem .7rem;
  }
  textarea{min-height:100px; resize:vertical}
  .row{display:flex; gap:.5rem; align-items:center; flex-wrap:wrap}
  .muted{opacity:.7;font-size:.9rem}
  .pill{padding:.2rem .5rem; border:1px solid #ffffff28; border-radius:999px; font-size:.75rem}
  .admin{color:#b4f5c6; border-color:#b4f5c680}
  .notice{position:fixed; left:50%; top:calc(1rem + 58px); transform:translateX(-50%); z-index:5; background:#101b33; border:1px solid #ffffff24; padding:.5rem .8rem; border-radius:10px; display:none}
  @media (max-width:700px){ .hud{gap:.35rem} .cta{left:50%; transform:translateX(-50%);}}
  
.hud {
  left:auto;
  right:1rem;
  max-width:220px;
  width:auto;
  display:flex;
  flex-direction:column;
}
.hud.compact {
  position: fixed;
  top: 1rem;
  right: 1rem;
  z-index: 5;
  background: rgba(0,0,0,0.4);
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 12px;
  padding: .8rem;
  backdrop-filter: blur(6px);
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: .4rem;
  width: fit-content;
}

.hud.compact h1 {
  font-size: 0.9rem;
  font-weight: 600;
  margin: 0 0 .2rem 0;
  color: #fff;
}

.hud.compact button {
  font-size: 0.8rem;
  padding: 0.4rem 0.6rem;
  border-radius: 8px;
}
.hud.compact {
  position: fixed;
  top: 1rem;
  right: 1rem;
  z-index: 10;
  background: rgba(15, 20, 40, 0.7);
  border: 1px solid rgba(255, 255, 255, 0.35);
  border-radius: 12px;
  padding: 0.8rem 1rem;
  backdrop-filter: blur(12px);
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 0.5rem;
  color: #fff;
  box-shadow: 0 0 18px rgba(0, 0, 0, 0.6);
  transition: opacity 0.3s ease;
}

.hud.compact h1 {
  font-size: 1rem;
  font-weight: 600;
  color: #fff;
  margin: 0;
}
.hud.compact button {
  background: rgba(255, 255, 255, 0.15);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 8px;
  font-size: 0.9rem;
  padding: 0.5rem 0.8rem;
  cursor: pointer;
  transition: background 0.2s ease, transform 0.1s ease;
}

.hud.compact button:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: scale(1.05);
}
.message-modal {
  border: none;
  border-radius: 12px;
  padding: 1.5rem;
  max-width: 400px;
  background: rgba(0, 0, 0, 0.85);
  color: #fff;
  backdrop-filter: blur(10px);
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
  animation: fadeIn 0.3s ease;
}
/* --- Fun message modal styling --- */
.message-modal {
  border: none;
  border-radius: 16px;
  padding: 1.8rem;
  max-width: 420px;
  background: rgba(15, 20, 40, 0.85);
  color: #fff;
  backdrop-filter: blur(10px);
  box-shadow: 0 0 25px rgba(255, 255, 255, 0.3), 0 0 60px rgba(0, 150, 255, 0.1);
  font-family: "Indie Flower", cursive;
  text-align: center;
  animation: popIn 0.4s ease-out;
  transform-origin: center;
}
.message-modal h2 {
  font-size: 1.8rem;
  color: #ffda79;
  margin-bottom: 0.6rem;
  text-shadow: 0 0 10px rgba(255, 255, 200, 0.8);
}
.message-modal p {
  font-size: 1.2rem;
  line-height: 1.5;
  white-space: pre-wrap;
}
/* --- Sparkle pop-in animation for message modal --- */
@keyframes sparklePop {
  0% {
    opacity: 0;
    transform: scale(0.8) rotate(-2deg);
    box-shadow: 0 0 0px rgba(255,255,255,0);
  }
  40% {
    opacity: 1;
    transform: scale(1.05) rotate(1deg);
    box-shadow:
      0 0 20px rgba(255,255,255,0.7),
      0 0 40px rgba(255,215,0,0.4),
      0 0 60px rgba(125,211,252,0.3);
  }
  100% {
    opacity: 1;
    transform: scale(1) rotate(0);
    box-shadow:
      0 0 12px rgba(255,255,255,0.4),
      0 0 25px rgba(125,211,252,0.2);
  }
}

.message-modal {
  animation: sparklePop 0.8s ease-out;
  transition: transform 0.3s ease, box-shadow 0.5s ease;
}
/* Soft "pop-in" animation */
@keyframes popIn {
  from {
    transform: scale(0.8);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}
@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}
/* --- Add Your Star button glow animation --- */
/* FORCE glowing Add Your Star button */
@keyframes pulseGlow {
  0% {
    box-shadow: 0 0 6px rgba(255, 255, 255, 0.4),
                0 0 12px rgba(255, 255, 255, 0.3),
                0 0 0px rgba(125, 211, 252, 0);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 12px rgba(255, 255, 255, 0.8),
                0 0 25px rgba(125, 211, 252, 0.8),
                0 0 40px rgba(125, 211, 252, 0.4);
    transform: scale(1.08);
  }
  100% {
    box-shadow: 0 0 6px rgba(255, 255, 255, 0.4),
                0 0 12px rgba(255, 255, 255, 0.3),
                0 0 0px rgba(125, 211, 252, 0);
    transform: scale(1);
  }
}
#addBtn {
  position: relative;
  z-index: 1000;
  animation: pulseGlow 2.8s ease-in-out infinite !important;
  transition: transform 0.2s, filter 0.3s;
}
#addBtn:hover {
  transform: scale(1.12);
  filter: brightness(1.3);
}
/* --- Shooting Star Animation (fixed visibility) --- */
@keyframes shootingStar {
  0% {
    transform: translate(0, 0) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(-2000px, 800px) scale(0.8);
    opacity: 0;
  }
}

.shooting-star {
  position: fixed;
  width: 3px;
  height: 3px;
  background: white;
box-shadow: 0 0 25px 8px rgba(255,255,255,0.95),
            0 0 80px 20px rgba(255,255,255,0.7);

  border-radius: 50%;
  z-index: 9999; /* ensure it's above all layers */
  opacity: 0;
  animation: shootingStar 1.4s linear forwards;
  pointer-events: none;
}
@keyframes shimmer {
  0%, 100% { filter: brightness(1) blur(0.5px); }
  50% { filter: brightness(1.5) blur(1px); }
}
.firework {
  position: fixed;
    width: 4px;
  height: 4px;
  border-radius: 50%;
  background: radial-gradient(circle, #fff 0%, #ffd700 70%, transparent 100%);
  pointer-events: none;
  animation: shootUp 2s ease-out forwards;
  z-index: 10;
  opacity: 0.9;
  box-shadow: 0 0 12px 3px rgba(255,255,255,0.9);
}

@keyframes shootUp {
  0% { transform: translateY(0); opacity: 1; }
  90% { opacity: 1; }
  100% { transform: translateY(-50vh); opacity: 0; }
}

.explosion {
  position: fixed;
  width: 3px;
  height: 3px;
  border-radius: 50%;
  pointer-events: none;
  animation: explode 1.8s ease-out forwards;
  mix-blend-mode: screen;
  z-index: 10;
    box-shadow: 0 0 12px rgba(255, 255, 255, 0.8),
              0 0 25px rgba(255, 192, 203, 0.6),
              0 0 45px rgba(255, 215, 0, 0.4);
}

@keyframes explode {
  0% { transform: scale(0.8); opacity: 1; }
  100% { transform: scale(1.3) translate(var(--x), var(--y)); opacity: 0; }
}
/* Ensure message stars stay visible above fireworks */
#message-layer {
  z-index: 20;
}
/* 🌠 Magical sparkle trail behind fireworks */
.spark-trail {
  position: fixed;
  width: 3px;
  height: 3px;
  border-radius: 50%;
  background: radial-gradient(circle, #fff 0%, #ffb6c1 60%, transparent 100%);
  pointer-events: none;
  opacity: 0.9;
  box-shadow:
    0 0 6px rgba(255, 255, 255, 0.8),
    0 0 12px rgba(255, 182, 193, 0.7),
    0 0 20px rgba(255, 215, 0, 0.6);
  animation: fadeTrail 0.8s ease-out forwards;
  mix-blend-mode: screen;
}

@keyframes fadeTrail {
  0% { opacity: 1; transform: scale(1); }
  100% { opacity: 0; transform: scale(0.6); }
}

/* --- Glittering Comet Trail --- */
.trail {
  position: fixed;
  width: 2px;
  height: 2px;
  border-radius: 50%;
  background: radial-gradient(circle, #fff 0%, #ffd700 60%, transparent 100%);
  pointer-events: none;
  opacity: 0.8;
  animation: trailFade 1s ease-out forwards;
  mix-blend-mode: screen;
  z-index: 8;
  box-shadow: 0 0 8px 2px rgba(255, 255, 255, 0.9);
}

@keyframes trailFade {
  0%   { opacity: 0.9; transform: scale(1); }
  50%  { opacity: 0.5; transform: scale(0.8); }
  100% { opacity: 0; transform: scale(0.5); }
}

@keyframes fadeTrail {
  0% { opacity: 1; transform: scale(1); }
  100% { opacity: 0; transform: scale(0.6); }
}

/* ✨ Magical star cursor when placing a star */
body.placing-star {
  cursor: url('https://cdn-icons-png.flaticon.com/512/616/616408.png') 16 16, crosshair;
}
/* ✨ Floating magical notice ✨ */
#notice {
  position: fixed;
  top: 1.5rem;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(15, 20, 40, 0.8);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 10px;
  padding: 0.6rem 1rem;
  font-size: 1rem;
  font-family: "Quicksand", sans-serif;
  text-shadow: 0 0 8px #fff;
  opacity: 0;
  pointer-events: none;
  backdrop-filter: blur(8px);
  box-shadow: 0 0 15px rgba(255,255,255,0.3);
  transition: opacity 0.6s ease, transform 0.6s ease;
  z-index: 99999;
}

#notice.show {
  opacity: 1;
  transform: translateX(-50%) scale(1.05);
}

/* ✨ Emoji Picker Styling ✨ */
.emoji-picker {
  display: flex;
  flex-wrap: wrap;
  gap: 0.4rem;
  font-size: 1.6rem;
  user-select: none;
  justify-content: center;
  margin-top: 0.5rem;
}

.emoji-picker span {
  cursor: pointer;
  transition: transform 0.2s ease;
}

.emoji-picker span:hover {
  transform: scale(1.25);
}
/* ✨ Soft glow effect on emoji hover ✨ */
.emoji-picker span {
  cursor: pointer;
  transition: transform 0.25s ease, filter 0.25s ease, text-shadow 0.25s ease;
}

.emoji-picker span:hover {
  transform: scale(1.3);
  filter: brightness(1.3);
  text-shadow: 0 0 8px rgba(255, 255, 255, 0.8),
               0 0 16px rgba(255, 192, 203, 0.6),
               0 0 24px rgba(255, 105, 180, 0.4);
}
/* 💫 Magical Add Star Modal Styling */
#addModal {
  background: rgba(25, 25, 55, 0.75);
  border: 1px solid rgba(255, 255, 255, 0.25);
  border-radius: 16px;
  padding: 2rem 2.5rem;
  backdrop-filter: blur(16px);
  box-shadow:
    0 0 20px rgba(255, 255, 255, 0.2),
    0 0 60px rgba(125, 211, 252, 0.15),
    inset 0 0 10px rgba(255, 255, 255, 0.05);
  color: #fff;
  font-family: "Quicksand", sans-serif;
  animation: modalAppear 0.6s ease;
}

@keyframes modalAppear {
  from { opacity: 0; transform: scale(0.8) translateY(20px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

#addModal h2 {
  text-align: center;
  font-size: 1.8rem;
  color: #fff;
  text-shadow: 0 0 12px #fff, 0 0 25px #7dd3fc;
  margin-bottom: 1rem;
}

/* Input & textarea glowing look */
#addModal input,
#addModal textarea {
  width: 100%;
  border: 1px solid rgba(255, 255, 255, 0.25);
  background: rgba(255, 255, 255, 0.08);
  color: #fff;
  border-radius: 8px;
  padding: 0.6rem 0.8rem;
  font-size: 1rem;
  font-family: inherit;
  transition: box-shadow 0.3s ease, border-color 0.3s ease;
}

#addModal input:focus,
#addModal textarea:focus {
  outline: none;
  border-color: #7dd3fc;
  box-shadow: 0 0 12px #7dd3fc, 0 0 20px #fff;
}

/* Buttons with starry glow */
#addModal button {
  padding: 0.6rem 1rem;
  border: none;
  border-radius: 10px;
  background: linear-gradient(90deg, #ff9ff3, #7dd3fc, #a78bfa);
  color: white;
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  box-shadow: 0 0 12px rgba(255, 255, 255, 0.3);
  transition: transform 0.25s ease, box-shadow 0.3s ease;
}

#addModal button:hover {
  transform: scale(1.05);
  box-shadow: 0 0 25px rgba(255, 255, 255, 0.6),
              0 0 40px rgba(125, 211, 252, 0.5);
}

/* Emoji picker fits the magic theme */
.emoji-picker {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  justify-content: center;
  font-size: 1.6rem;
  padding-top: 0.6rem;
}

.emoji-picker span {
  cursor: pointer;
  transition: transform 0.25s ease, filter 0.25s ease;
}

.emoji-picker span:hover {
  transform: scale(1.25);
  filter: brightness(1.4);
}
#addModal::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 16px;
  background: radial-gradient(circle at 20% 30%, rgba(255,255,255,0.15), transparent 60%),
              radial-gradient(circle at 80% 70%, rgba(125,211,252,0.1), transparent 60%);
  animation: shimmerFlow 6s infinite ease-in-out alternate;
  z-index: -1;
}

@keyframes shimmerFlow {
  0% { opacity: 0.3; transform: scale(1); }
  100% { opacity: 0.7; transform: scale(1.1); }
}
/* 🌠 Ghibli-Style Realistic Fireworks + Sparkle Trails */
.firework {
  position: fixed;
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: radial-gradient(circle, #fff 0%, #ffecb3 40%, transparent 100%);
  opacity: 0.9;
  pointer-events: none;
  box-shadow:
    0 0 8px rgba(255, 255, 255, 0.9),
    0 0 18px rgba(255, 215, 0, 0.7),
    0 0 32px rgba(255, 182, 193, 0.5);
  mix-blend-mode: screen;
  animation: rise 1.2s ease-out forwards;
  z-index: 10;
}

@keyframes rise {
  0% {
    transform: translateY(0);
    opacity: 1;
  }
  70% {
    opacity: 1;
  }
  100% {
    transform: translateY(-150px);
    opacity: 0;
  }
}

/* 🌠 Magical Spark Trail */
.spark-trail {
  position: fixed;
  width: 3px;
  height: 3px;
  border-radius: 50%;
  background: radial-gradient(circle, #fff 0%, #ffb6c1 60%, transparent 100%);
  pointer-events: none;
  opacity: 0.9;
  box-shadow:
    0 0 6px rgba(255, 255, 255, 0.8),
    0 0 12px rgba(255, 182, 193, 0.7),
    0 0 20px rgba(255, 215, 0, 0.6);
  animation: fadeTrail 0.8s ease-out forwards;
  mix-blend-mode: screen;
  z-index: 9;
}

@keyframes fadeTrail {
  0% { opacity: 1; transform: scale(1); }
  100% { opacity: 0; transform: scale(0.6); }
}

</style>
</head>
<body>
  <canvas id="star-canvas" aria-hidden="true"></canvas>
  <img class="bg-fill" src="IsaBday.png" alt="" aria-hidden="true" loading="eager" />
  <img class="bg-img"  src="IsaBday.png" alt="" aria-hidden="true" loading="eager" />

  <div id="message-layer"></div>

  <div class="hud compact" role="toolbar">
  <h1>✨ Add your star for Isa</h1>
  <button id="addBtn" class="accent">Add Your Star ✨</button>
  <button id="loginBtn" class="ghost">Admin</button>
  <button id="logoutBtn" class="ghost" style="display:none">Sign out</button>
</div>

  <div class="cta">
    <span class="muted">Tip: click the sky to place your star</span>
  </div>
</dialog>

<!-- 🌟 Add Star Modal -->
<dialog id="addModal">
  <form id="addForm" method="dialog">
    <h2>Add Your Star ✨</h2>
    <p class="muted">You clicked at: <span id="coordsText">x0,y0</span>. Enter your name & message.</p>

    <div class="field">
      <label>Your Name</label>
      <input id="nameInput" maxlength="40" required placeholder="Your name" />
    </div>

    <div class="field">
      <label>Message</label>
      <textarea id="msgInput" maxlength="300" required placeholder="Write a sweet note…"></textarea>

      <!-- ✨ Emoji Picker -->
      <div class="emoji-picker" id="emojiPicker">
  <span>🌟</span> <span>🎂</span> <span>🎈</span> <span>💖</span> <span>🥳</span>
  <span>✨</span> <span>🎶</span> <span>💫</span>
  <span>❤️</span> <span>🧡</span> <span>💛</span> <span>💚</span> <span>💙</span> <span>💜</span>
  <span>🤎</span> <span>🖤</span> <span>🤍</span>
  <span>💗</span> <span>💓</span> <span>💞</span> <span>💕</span> <span>💘</span> <span>💝</span>
  <span>💟</span> <span>💔</span> <span>💌</span>
  <span>🌈</span> <span>🎉</span> <span>🥰</span>
</div>
    </div>

    <div class="row">
      <button type="submit" class="accent" id="saveStar">Save Star</button>
      <button type="button" id="cancelAdd" class="ghost">Cancel</button>
    </div>
  </form>
</dialog>

<!-- ✨ Notice message -->
<div id="notice">Click the sky to place your star ✨</div>

  <!-- View/Edit Modal -->
  <dialog id="viewModal" class="message-modal">
  <div id="viewContent"></div>
  <div class="row" style="margin-top:.75rem">
    <button id="closeView" class="ghost">Close</button>
    <div class="spacer"></div>
    <button id="editBtn" class="ghost" style="display:none">Edit</button>
    <button id="deleteBtn" class="danger" style="display:none">Delete</button>
  </div>
</dialog>

  <!-- Edit Modal -->
  <dialog id="editModal">
    <form id="editForm" method="dialog">
      <h3>Edit message</h3>
      <div class="field">
        <label>Name</label>
        <input id="editName" maxlength="40" required>
      </div>
      <div class="field">
        <label>Message</label>
        <textarea id="editMsg" maxlength="300" required></textarea>
      </div>
      <div class="row">
        <button type="submit" class="accent">Save</button>
        <button type="button" id="cancelEdit" class="ghost">Cancel</button>
      </div>
    </form>
  </dialog>

  <!-- Admin Login -->
  <dialog id="adminModal">
    <form id="adminForm" method="dialog">
      <h3>Admin sign in</h3>
      <p class="muted">Admins can edit or delete stars and export/import.</p>
      <div class="field">
        <label>Email</label>
        <input id="adminEmail" type="email" placeholder="admin@example.com" required>
      </div>
      <div class="field">
        <label>Password</label>
        <input id="adminPass" type="password" required value="isasings111">
      </div>
      <div class="row">
        <button type="submit" class="accent">Sign in</button>
        <button type="button" id="cancelAdmin" class="ghost">Cancel</button>
      </div>
      <div class="row" style="margin-top:.5rem; gap:.4rem">
        <button type="button" id="exportBtn" class="ghost" style="display:none">Export JSON</button>
        <label class="btn ghost" style="display:none" id="importLabel">Import JSON<input id="importFile" type="file" accept="application/json" hidden></label>
      </div>
    </form>
  </dialog>

  <!-- Firebase (modular v10) -->
<script type="module">

function createFirework() {
  const fw = document.createElement("div");
  fw.className = "firework";

  // Random scale and brightness depth
  const depth = Math.random();
  let scale, opacity;
  if (depth < 0.3) { scale = 0.4; opacity = 0.6; }
  else if (depth < 0.7) { scale = 0.7; opacity = 0.8; }
  else { scale = 1.0; opacity = 1.0; }

  // --- Starting and ending coordinates ---
  const startX = Math.random() * window.innerWidth;
  const startY = window.innerHeight * 0.85;  // near bottom of screen
  const endY = window.innerHeight * 0.35;    // mid-sky burst height
  const arcX = startX + (Math.random() - 0.5) * 200; // small horizontal arc

  fw.style.left = `${startX}px`;
  fw.style.top = `${startY}px`; // use TOP instead of bottom!
  fw.style.transform = `scale(${scale})`;
  fw.style.opacity = opacity;
  document.body.appendChild(fw);

  // 🌟 Sparkle trail
  const trailInterval = setInterval(() => {
    const rect = fw.getBoundingClientRect();
    const trail = document.createElement("div");
    trail.className = "spark-trail";
    trail.style.left = `${rect.left + 2}px`;
    trail.style.top = `${rect.top + 2}px`;
    document.body.appendChild(trail);
    setTimeout(() => trail.remove(), 800);
  }, 50);

  // --- Animate upward arc ---
  const distanceY = endY - startY; // negative = upward
  const duration = 1800 + Math.random() * 400;

  const animation = fw.animate(
    [
      { transform: `translate(0, 0) scale(${scale})`, opacity: 1 },
      { transform: `translate(${(arcX - startX) * 0.4}px, ${distanceY * 0.6}px) scale(${scale * 1.1})`, opacity: 1 },
      { transform: `translate(${arcX - startX}px, ${distanceY}px) scale(${scale * 0.8})`, opacity: 0.8 }
    ],
    { duration, easing: "ease-out", fill: "forwards" }
  );

  animation.onfinish = () => {
    clearInterval(trailInterval);
    const rect = fw.getBoundingClientRect();
    const endX = rect.left + rect.width / 2;
    const endY = rect.top + rect.height / 2; // top-based coordinate
    fw.remove();

    createExplosion(endX, endY, scale);
  };
}

/* === Firebase Setup === */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import { getAuth, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyADhhtFZZcRMOwqU_dwR7RMHITYsfvXDUY",
  authDomain: "isa-s-25th-birthday.firebaseapp.com",
  projectId: "isa-s-25th-birthday",
  storageBucket: "isa-s-25th-birthday.firebasestorage.app",
  messagingSenderId: "590841309751",
  appId: "1:590841309751:web:bb444deda0263f1b9fedb2"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

/* === DOM Elements === */
const layer = document.getElementById("message-layer");
const addBtn = document.getElementById("addBtn");
const addModal = document.getElementById("addModal");
const addForm = document.getElementById("addForm");
const cancelAdd = document.getElementById("cancelAdd");
const viewModal = document.getElementById("viewModal");
const viewContent = document.getElementById("viewContent");
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const adminModal = document.getElementById("adminModal");
const adminForm = document.getElementById("adminForm");
const cancelAdmin = document.getElementById("cancelAdmin");

/* === Input Fields === */
const nameInput = document.getElementById("nameInput");
const emojiPicker = document.getElementById("emojiPicker");
const msgInput = document.getElementById("msgInput");

/* === Emoji Picker === */
emojiPicker.addEventListener("click", e => {
  if (e.target.tagName === "SPAN") {
    const emoji = e.target.textContent;
    const start = msgInput.selectionStart;
    const end = msgInput.selectionEnd;
    msgInput.value = msgInput.value.slice(0, start) + emoji + msgInput.value.slice(end);
    msgInput.focus();
    msgInput.selectionEnd = start + emoji.length;
  }
});

/* === Name Validation === */
nameInput.addEventListener("input", () => {
  nameInput.value = nameInput.value.replace(/[^a-zA-Z\s]/g, "");
});

/* === Star Placement === */
let currentX = 0, currentY = 0, admin = false, isPlacing = false;

addBtn.onclick = () => {
  isPlacing = true;
  document.body.classList.add("placing-star");
  const notice = document.getElementById("notice");
  notice.textContent = "Click the sky to place your star ✨";
  notice.style.display = "block";
  notice.classList.add("show");
};

document.addEventListener("click", e => {
  if (!isPlacing) return;
  if (e.target.closest("button, dialog, .mstar, .tooltip")) return;

  isPlacing = false;
  document.body.classList.remove("placing-star");

  const notice = document.getElementById("notice");
  notice.classList.remove("show");
  notice.style.display = "none";

  currentX = e.clientX;
  currentY = e.clientY;
  addModal.showModal();
});

cancelAdd.onclick = () => addModal.close();

/* === Add Star Form === */
addForm.onsubmit = async e => {
  e.preventDefault();
  const name = nameInput.value.trim();
  const message = msgInput.value.trim();
  if (!name || !message) return alert("Please enter your name and message 🌟");

  await addDoc(collection(db, "messages"), { name, message, x: currentX, y: currentY });
  addModal.close();
  renderStars();
};

/* === Render Stars === */
async function renderStars() {
  layer.innerHTML = "";
  const snapshot = await getDocs(collection(db, "messages"));
  snapshot.forEach(docSnap => {
    const data = docSnap.data();
    const el = document.createElement("div");
    el.className = "mstar";
    el.style.left = `${data.x}px`;
    el.style.top = `${data.y}px`;

    const tip = document.createElement("div");
    tip.className = "tooltip";
    tip.textContent = `${data.name} 🌟`;
    el.appendChild(tip);

    el.onclick = () => openView(docSnap.id, data);
    layer.appendChild(el);
  });
}

/* === View Star === */
function openView(id, data) {
  viewContent.innerHTML = `<h2>${data.name}</h2><p>${data.message}</p>`;
  const editBtn = document.getElementById("editBtn");
  const deleteBtn = document.getElementById("deleteBtn");

  if (admin) {
    editBtn.style.display = "inline-block";
    deleteBtn.style.display = "inline-block";
  } else {
    editBtn.style.display = "none";
    deleteBtn.style.display = "none";
  }

  deleteBtn.onclick = async () => {
    if (confirm("Delete this star?")) {
      await deleteDoc(doc(db, "messages", id));
      alert("🌟 Star deleted!");
      viewModal.close();
      renderStars();
    }
  };

  document.getElementById("closeView").onclick = () => viewModal.close();
  viewModal.showModal();
}

renderStars();

/* === Admin Login === */
loginBtn.onclick = () => adminModal.showModal();
cancelAdmin.onclick = () => adminModal.close();

adminForm.onsubmit = async e => {
  e.preventDefault();
  const email = document.getElementById("adminEmail").value;
  const pass = document.getElementById("adminPass").value;
  try {
    await signInWithEmailAndPassword(auth, email, pass);
    admin = true;
    adminModal.close();
    loginBtn.style.display = "none";
    logoutBtn.style.display = "inline-block";
    alert("✅ Admin signed in!");
  } catch (err) {
    alert("❌ Login failed: " + err.message);
  }
};

logoutBtn.onclick = async () => {
  await signOut(auth);
  admin = false;
  logoutBtn.style.display = "none";
  loginBtn.style.display = "inline-block";
  alert("Signed out.");
};
</script>
</body>
</html>